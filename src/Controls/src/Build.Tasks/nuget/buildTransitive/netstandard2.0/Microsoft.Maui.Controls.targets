<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<UsingTask TaskName="Microsoft.Maui.Controls.Build.Tasks.XamlCTask" AssemblyFile="$(MSBuildThisFileDirectory)Microsoft.Maui.Controls.Build.Tasks.dll" />

	<PropertyGroup>
		<SynthesizeLinkMetadata>true</SynthesizeLinkMetadata>
		<EnableDefaultXamlItems Condition="'$(EnableDefaultXamlItems)'==''">True</EnableDefaultXamlItems>
		<EnableDefaultCssItems Condition="'$(EnableDefaultCssItems)'==''">True</EnableDefaultCssItems>
    <!-- default MauiXaml inflators  -->
    <_MauiXamlInflator Condition="' $(MauiXamlInflator)' != '' ">$(MauiXamlInflator)</_MauiXamlInflator>
    <_MauiXamlInflator Condition=" '$(MauiXamlInflator)' == '' And '$(Configuration)' == 'Debug' ">Runtime</_MauiXamlInflator>
    <_MauiXamlInflator Condition=" '$(MauiXamlInflator)' == '' And '$(Configuration)' != 'Debug' ">XamlC</_MauiXamlInflator>

    <EnableMauiXamlDiagnostics Condition=" '$(EnableMauiXamlDiagnostics)' == '' ">$(EnableMauiDiagnostics)</EnableMauiXamlDiagnostics>
    <EnableMauiXamlDiagnostics Condition=" '$(EnableMauiXamlDiagnostics)' == '' And '$(Configuration)' == 'Debug' ">$(EnableDiagnostics)</EnableMauiXamlDiagnostics>
    <EnableMauiXamlDiagnostics Condition=" '$(EnableMauiXamlDiagnostics)' == '' And '$(Configuration)' == 'Debug' ">true</EnableMauiXamlDiagnostics>
    
    <MauiXamlNoWarn Condition=" '$(MauiXamlNoWarn)' != '' ">$(MauiXamlNoWarn.Replace(';', ','))</MauiXamlNoWarn>
    
		<!-- The WINUI check for this only runs when there is an empty string so I just convert false to an empty string to fall in line with our other properties -->
		<SkipMicrosoftUIXamlCheckTargetPlatformVersion Condition="'$(SkipMicrosoftUIXamlCheckTargetPlatformVersion)'==''">true</SkipMicrosoftUIXamlCheckTargetPlatformVersion>
		<SkipMicrosoftUIXamlCheckTargetPlatformVersion Condition="'$(SkipMicrosoftUIXamlCheckTargetPlatformVersion)'=='false'"></SkipMicrosoftUIXamlCheckTargetPlatformVersion>
		<AndroidUseDefaultAotProfile Condition="'$(AndroidEnableProfiledAot)' == 'true' and '$(AndroidUseDefaultAotProfile)' == ''">false</AndroidUseDefaultAotProfile>
	</PropertyGroup>

	<ItemGroup>
		<AvailableItemName Include="MauiXaml" />
		<AvailableItemName Include="MauiCss" />
	</ItemGroup>

	<ItemGroup Condition=" '$(DisableMauiAnalyzers)' != 'true' ">
		<Analyzer Include="$(MSBuildThisFileDirectory)Microsoft.Maui.Controls.SourceGen.dll" IsImplicitlyDefined="true" />
	</ItemGroup>

	<!-- Enable BindingSourceGen -->
	<PropertyGroup>
		<_MauiBindingInterceptorsSupport Condition=" '$(_MauiBindingInterceptorsSupport)' == '' and '$(DisableMauiAnalyzers)' != 'true' ">true</_MauiBindingInterceptorsSupport>
		<InterceptorsPreviewNamespaces Condition=" '$(_MauiBindingInterceptorsSupport)' == 'true' ">$(InterceptorsPreviewNamespaces);Microsoft.Maui.Controls.Generated</InterceptorsPreviewNamespaces>
	</PropertyGroup>
	<ItemGroup Condition=" '$(_MauiBindingInterceptorsSupport)' == 'true' ">
		<Analyzer Include="$(MSBuildThisFileDirectory)Microsoft.Maui.Controls.BindingSourceGen.dll" IsImplicitlyDefined="true" />
	</ItemGroup>

	<ItemGroup Condition="'$(AndroidEnableProfiledAot)' == 'true' and '$(MauiUseDefaultAotProfile)' != 'false'">
		<AndroidAotProfile Include="$(MSBuildThisFileDirectory)maui.aotprofile" />
		<AndroidAotProfile Include="$(MSBuildThisFileDirectory)maui-sc.aotprofile" />
		<AndroidAotProfile Include="$(MSBuildThisFileDirectory)maui-blazor.aotprofile" />
	</ItemGroup>

	<!-- Check Tasks ABI and other validations -->
	<PropertyGroup>
		<_MauiTargetsImportedAgain Condition="'$(_MauiTargetsImported)'=='True'">True</_MauiTargetsImportedAgain>
		<_MauiTargetsImported>True</_MauiTargetsImported>
		<IsXBuild Condition="'$(MSBuildRuntimeType)' == ''">true</IsXBuild>
		<IsXBuild Condition="'$(MSBuildRuntimeType)' != ''">false</IsXBuild>
	</PropertyGroup>

	<Target Name="_ValidateMauiTasks" BeforeTargets="_CheckForInvalidConfigurationAndPlatform" Condition="'$(MauiDisableTargetsValidation)' != 'True'">
		<Error Code="XF001"
			Text="Microsoft.Maui targets have been imported multiple times. Please check your project file and remove the duplicate import(s)."
			Condition="'$(_MauiTargetsImportedAgain)' == 'True'" />
	</Target>

	<Target Name="_ValidateMSBuild" BeforeTargets="_CheckForInvalidConfigurationAndPlatform">
		<Error Code="XF003"
			Text="Microsoft.Maui requires msbuild. xbuild is no longer supported."
			Condition="'$(IsXBuild)' == 'true'" />
	</Target>

	<Target Name="_ValidateNETFrameworkVersion"
			BeforeTargets="_CheckForInvalidConfigurationAndPlatform"
			Condition="'$(ProjectExt)' != '.wapproj' AND '$(TargetFrameworkIdentifier)' == '.NETFramework' AND '$(TargetFrameworkVersion.Substring(1))' &lt; '4.6.1' AND '$(MauiDisableFrameworkVersionValidation)' != 'True'">
		<Error Code="XF004"
			Text="Microsoft.Maui requires .NETFramework >= v4.6.1. You have '$(TargetFrameworkVersion)'" />
	</Target>

	<Target
		Name="_ValidateMauiDoesNotHaveXamarinForms"
		BeforeTargets="_CheckForInvalidConfigurationAndPlatform"
		Condition="'$(MauiDisableXamarinFormsValidation)' != 'True'">
		<Error
			Code="MA001"
			Text="This project or a dependency has imported the Xamarin.Forms packages. .NET MAUI is not compatible with Xamarin.Forms and is unable to build. Please remove Xamarin.Forms or the project/package dependency that is using Xamarin.Forms."
			Condition="'$(_XFTargetsImported)' == 'true'"/>
	</Target>

  <Target Name="_MauiXamlComputeInflator">
  	<ItemGroup>
      <!-- Compute the configuration-based default inflator (independent of MauiXamlInflator property) -->
      <_MauiXamlDefaultInflator Condition=" '$(Configuration)' == 'Debug' " Include="Runtime" />
      <_MauiXamlDefaultInflator Condition=" '$(Configuration)' != 'Debug' " Include="XamlC" />
      
      <!-- Assign the default inflator to MauiXaml that don't have any -->
      <!-- there's a roslyn bug that stops parsing value at the first semicolon. replace them all https://github.com/dotnet/roslyn/issues/43970 -->
      <!-- Special value 'Default' reverts to configuration-based defaults (Runtime in Debug, XamlC in Release) -->
      <MauiXaml Condition="'%(MauiXaml.Inflator)' == 'Default'" Inflator="@(_MauiXamlDefaultInflator)" />
      <MauiXaml Inflator="$([MSBuild]::ValueOrDefault('%(MauiXaml.Inflator)','$(_MauiXamlInflator)').Replace(';', ','))"/>
      <MauiXaml NoWarn="$([MSBuild]::ValueOrDefault('%(MauiXaml.NoWarn)','').Replace(';', ','))"/>

	    <_MauiXaml_SG Remove="@(_MauiXaml_SG)" />
	    <_MauiXaml_RT Remove="@(_MauiXaml_RT)" />
	    <_MauiXaml_XC Remove="@(_MauiXaml_XC)" />
	    <_MauiXaml_SG Include="@(MauiXaml)" Condition="$([System.String]::new('%(MauiXaml.Inflator)').ToLowerInvariant().Contains('sourcegen'))" />
	    <_MauiXaml_RT Include="@(MauiXaml)" Condition="$([System.String]::new('%(MauiXaml.Inflator)').ToLowerInvariant().Contains('runtime'))" />
	    <_MauiXaml_XC Include="@(MauiXaml)" Condition="$([System.String]::new('%(MauiXaml.Inflator)').ToLowerInvariant().Contains('xamlc'))" />
      <_MauiXaml_AsEmbeddedResource Include="@(_MauiXaml_RT)" />
      <_MauiXaml_AsEmbeddedResource Include="@(_MauiXaml_XC)" KeepDuplicates="false" />      
	</ItemGroup>
	
	<!-- Inform when XAML source generation is enabled -->
	<Message 
		Text="XAML source generation is enabled (MauiXamlInflator=SourceGen). This generates C# code from XAML at compile time for better performance. To disable, remove the MauiXamlInflator line from your .csproj file or set it to Runtime." 
		Importance="high" 
		Condition="'$(MauiXamlInflator)' != '' And $([System.String]::new('$(MauiXamlInflator)').ToLowerInvariant().Contains('sourcegen'))" />
	
	<!-- Warn when Runtime or XamlC inflator is explicitly set -->
	<Warning 
		Code="MAUI1001"
		Text="MauiXamlInflator is explicitly set to '$(MauiXamlInflator)'. Runtime negatively impacts build performance, and XamlC prevents debugging capabilities like XAML Hot Reload. Consider setting it to 'SourceGen' for optimal performance and debugging experience, or remove it to use configuration-based defaults (Runtime in Debug, XamlC in Release)." 
		Condition="'$(MauiXamlInflator)' != '' And ($([System.String]::new('$(MauiXamlInflator)').ToLowerInvariant().Contains('runtime')) Or $([System.String]::new('$(MauiXamlInflator)').ToLowerInvariant().Contains('xamlc')))" />
  </Target>

  <!-- Inject MauiXaml and MauiCss as AdditionalFiles for partial type generation-->
  <PropertyGroup>
    <_MauiInjectXamlCssAdditionalFilesDependsOn>
      _MauiXamlComputeInflator;
      $(CreateManifestResourceNamesDependsOn);
    </_MauiInjectXamlCssAdditionalFilesDependsOn>
  </PropertyGroup>
    
  <Target Name="_MauiInjectXamlCssAdditionalFiles"
          BeforeTargets="GenerateMSBuildEditorConfigFileShouldRun"
          DependsOnTargets="$(_MauiInjectXamlCssAdditionalFilesDependsOn)">
    <ItemGroup>
      <_MauiXamlWithResourceNames Remove="@(_MauiXamlWithResourceNames)" />
      <_MauiXamlWithTargetPath Remove="@(_MauiXamlWithTargetPath)" />
      <_MauiCssWithResourceNames Remove="@(_MauiCssWithResourceNames)" />
      <_MauiCssWithTargetPath Remove="@(_MauiCssWithTargetPath)" />
    </ItemGroup>

    <AssignTargetPath Files="@(MauiXaml)" RootFolder="$(MSBuildProjectDirectory)">
      <Output TaskParameter="AssignedFiles" ItemName="_MauiXamlWithTargetPath" />
    </AssignTargetPath>

    <AssignTargetPath Files="@(MauiCss)" RootFolder="$(MSBuildProjectDirectory)">
      <Output TaskParameter="AssignedFiles" ItemName="_MauiCssWithTargetPath" />
    </AssignTargetPath>

    <CreateCSharpManifestResourceName
              ResourceFiles="@(_MauiXamlWithTargetPath -> '%(FullPath)')"
              RootNamespace="$(RootNamespace)"
              UseDependentUponConvention="$(EmbeddedResourceUseDependentUponConvention)">
      <Output TaskParameter="ResourceFilesWithManifestResourceNames" ItemName="_MauiXamlWithResourceNames" />
    </CreateCSharpManifestResourceName>

    <CreateCSharpManifestResourceName
              ResourceFiles="@(_MauiCssWithTargetPath -> '%(FullPath)')"
              RootNamespace="$(RootNamespace)"
              UseDependentUponConvention="$(EmbeddedResourceUseDependentUponConvention)">
      <Output TaskParameter="ResourceFilesWithManifestResourceNames" ItemName="_MauiCssWithResourceNames" />
    </CreateCSharpManifestResourceName>
    <ItemGroup>
      <AdditionalFiles Condition="%(_MauiXamlWithResourceNames.TargetPath) != ''"
            Include="@(_MauiXamlWithResourceNames)"
            ManifestResourceName="%(_MauiXamlWithResourceNames.ManifestResourceName)"
            TargetPath="%(_MauiXamlWithResourceNames.TargetPath)"
            RelativePath="$([MSBuild]::MakeRelative($(MSBuildProjectDirectory), %(_MauiXamlWithResourceNames.TargetPath)))"
            ItemSpec="%(_MauiXamlWithResourceNames.OriginalItemSpec)"
            Inflator="%(_MauiXamlWithResourceNames.Inflator)"
            GenKind="Xaml"/>
      <AdditionalFiles Condition="%(_MauiCssWithResourceNames.TargetPath) != ''"
            Include="@(_MauiCssWithResourceNames)"
            ManifestResourceName="%(_MauiCssWithResourceNames.ManifestResourceName)"
            TargetPath="%(_MauiCssWithResourceNames.TargetPath)"
            RelativePath="$([MSBuild]::MakeRelative($(MSBuildProjectDirectory), %(_MauiCssWithResourceNames.TargetPath)))"
            ItemSpec="%(_MauiCssWithResourceNames.OriginalItemSpec)"
            GenKind="Css"/>
      <_MauiXamlWithResourceNames Remove="@(_MauiXamlWithResourceNames)" />
      <_MauiXamlWithTargetPath Remove="@(_MauiXamlWithTargetPath)" />
      <_MauiCssWithResourceNames Remove="@(_MauiCssWithResourceNames)" />
      <_MauiCssWithTargetPath Remove="@(_MauiCssWithTargetPath)" />
    </ItemGroup>
  </Target>


  <!-- re-add MauiXaml and MauiCss as EmbeddedResources for runtime inflation and XamlC -->
  <PropertyGroup>
    <PrepareResourcesDependsOn>
      _MauiAddXamlEmbeddedResources;
      $(PrepareResourcesDependsOn);
    </PrepareResourcesDependsOn>
    <_MauiAddXamlEmbeddedResourcesDependsOn>
      _MauiXamlComputeInflator
    </_MauiAddXamlEmbeddedResourcesDependsOn>
  </PropertyGroup>

  <Target Name="_MauiAddXamlEmbeddedResources"
          DependsOnTargets="$(_MauiAddXamlEmbeddedResourcesDependsOn)">
    <ItemGroup>
      <EmbeddedResource Include="@(_MauiXaml_AsEmbeddedResource)" />
      <EmbeddedResource Include="@(MauiCss)" />
    </ItemGroup>
  </Target>

	<!-- XamlC -->
	<PropertyGroup>
		<CompileDependsOn>
			$(CompileDependsOn);
			XamlC;
		</CompileDependsOn>
	</PropertyGroup>

	<Target Name="XamlC"
		AfterTargets="AfterCompile"
		Inputs="$(IntermediateOutputPath)$(TargetFileName)"
		Outputs="$(IntermediateOutputPath)XamlC.stamp"
		Condition=" '$(DesignTimeBuild)' != 'True' AND '@(MauiXaml)' != ''">
		<PropertyGroup>
			<_MauiXamlCValidateOnly>$(MauiXamlCValidateOnly)</_MauiXamlCValidateOnly>
			<_MauiXamlCValidateOnly Condition="'$(Configuration)' == 'Debug' AND '$(_MauiForceXamlCForDebug)' != 'True'">True</_MauiXamlCValidateOnly>
			<_MauiXamlCValidateOnly Condition="'$(BuildingForLiveUnitTesting)' == 'True' ">True</_MauiXamlCValidateOnly>

			<MauiStrictXamlCompilation Condition="'$(MauiStrictXamlCompilation)' == '' and ('$(PublishAot)' == 'true' or '$(TrimMode)' == 'full')">true</MauiStrictXamlCompilation>
			<_MauiXamlCWarningsNotAsErrors>$(WarningsNotAsErrors)</_MauiXamlCWarningsNotAsErrors>
			<_MauiXamlCWarningsNotAsErrors Condition="'$(MauiStrictXamlCompilation)' != 'true'">$(_MauiXamlCWarningsNotAsErrors);XC0022;XC0023;XC0025</_MauiXamlCWarningsNotAsErrors>

      <_MauiXamlCGenerateFullPaths Condition="'$(_MauiXamlCGenerateFullPaths)' == '' and '$(GenerateFullPaths)' == 'true'">true</_MauiXamlCGenerateFullPaths>
      <_MauiXamlCGenerateFullPaths Condition="'$(_MauiXamlCGenerateFullPaths)' == ''">false</_MauiXamlCGenerateFullPaths>
      <_MauiXamlCFullPathPrefix Condition="'$(_MauiXamlCFullPathPrefix)' == '' and '$(_MauiXamlCGenerateFullPaths)' == 'true'">$(MSBuildProjectDirectory)</_MauiXamlCFullPathPrefix>
		</PropertyGroup>
		<XamlCTask
			Assembly = "$(IntermediateOutputPath)$(TargetFileName)"
			ReferencePath = "@(ReferencePath)"
			OptimizeIL = "true"
			DebugSymbols = "$(DebugSymbols)"
			DebugType = "$(DebugType)"
			DefaultCompile = "true"
      CompileBindingsWithSource = "$(MauiEnableXamlCBindingWithSourceCompilation)"
			ValidateOnly = "$(_MauiXamlCValidateOnly)"
			TargetFramework = "$(TargetFramework)"
			KeepXamlResources = "$(MauiKeepXamlResources)"

      WarningLevel = "$(WarningLevel)"
      TreatWarningsAsErrors = "$(TreatWarningsAsErrors)"
      NoWarn = "$(NoWarn)"
      WarningsAsErrors = "$(WarningsAsErrors)"
      WarningsNotAsErrors = "$(_MauiXamlCWarningsNotAsErrors)"
      GenerateFullPaths = "$(_MauiXamlCGenerateFullPaths)"
      FullPathPrefix = "$(_MauiXamlCFullPathPrefix)" />
      
		<Touch Files="$(IntermediateOutputPath)XamlC.stamp" AlwaysCreate="True" />
		<ItemGroup>
			<FileWrites Include="$(IntermediateOutputPath)XamlC.stamp" />
		</ItemGroup>
	</Target>

 <!--
    Platform Specific Targets.
    We can't use a framework specific targets file because it breaks shared projects i.e.  /build/MonoAndroid10/Microsoft.Maui.Controls.targets
  -->

  <!-- MonoAndroid targets. -->
  <PropertyGroup Condition="'$(TargetFrameworkIdentifier)' == 'MonoAndroid'">
    <CoreCompileDependsOn>
      IncludeProguardForAndroid;
      $(CoreCompileDependsOn);
    </CoreCompileDependsOn>
    <PrepareForBuildDependsOn>
      ValidateTargetFrameworkVersionForMaui;
      $(PrepareForBuildDependsOn);
    </PrepareForBuildDependsOn>
  </PropertyGroup>

  <Target Name="IncludeProguardForAndroid" Condition="'$(MauiDisableDefaultProguardConfiguration)' != 'True'">
    <ItemGroup>
      <ProguardConfiguration Include="$(MSBuildThisFileDirectory)MonoAndroid10\proguard.cfg" />
    </ItemGroup>
  </Target>

  <Target Name="ValidateTargetFrameworkVersionForMaui" Condition="'$(MauiDisableTargetFrameworkValidation)' != 'True'">
    <PropertyGroup>
      <MinTargetFrameworkVersionForMaui>10.0</MinTargetFrameworkVersionForMaui>
      <TargetFrameworkVersionWithoutV>$(TargetFrameworkVersion.TrimStart('vV'))</TargetFrameworkVersionWithoutV>
    </PropertyGroup>
    <Error Code="XF005"  Condition="$(TargetFrameworkVersionWithoutV) &lt; $(MinTargetFrameworkVersionForMaui)"
           Text="The %24(TargetFrameworkVersion) for $(ProjectName) ($(TargetFrameworkVersion)) is less than the minimum required %24(TargetFrameworkVersion) for Microsoft.Maui ($(MinTargetFrameworkVersionForMaui)). You need to increase the %24(TargetFrameworkVersion) for $(ProjectName)."   />
  </Target>

  <Target Name="_MauiPrepareForILLink" BeforeTargets="PrepareForILLink;_GenerateRuntimeConfigurationFilesInputCache;XamlC">
    <PropertyGroup>
      <MauiEnableIVisualAssemblyScanning Condition="'$(MauiEnableIVisualAssemblyScanning)' == ''">false</MauiEnableIVisualAssemblyScanning>
    </PropertyGroup>
    
    <!-- Validate _EnableMauiAspire usage - warn when user manually sets it in optimized builds where it conflicts with intended behavior -->
    <Warning
      Code="MA002"
      Text="The _EnableMauiAspire property should not be set manually. Using Aspire outside the Debug configuration may introduce performance and security risks in production. This property is automatically configured based on build configuration."
      Condition="'$(_EnableMauiAspire)' != '' and '$(Optimize)' == 'true' and '$(MauiDisableAspireValidation)' != 'True'"/>
    
    <PropertyGroup Condition="'$(PublishAot)' == 'true' or '$(TrimMode)' == 'full'">
      <MauiShellSearchResultsRendererDisplayMemberNameSupported Condition="'$(MauiShellSearchResultsRendererDisplayMemberNameSupported)' == ''">false</MauiShellSearchResultsRendererDisplayMemberNameSupported>
      <MauiQueryPropertyAttributeSupport Condition="'$(MauiQueryPropertyAttributeSupport)' == ''">false</MauiQueryPropertyAttributeSupport>
      <MauiImplicitCastOperatorsUsageViaReflectionSupport Condition="'$(MauiImplicitCastOperatorsUsageViaReflectionSupport)' == ''">false</MauiImplicitCastOperatorsUsageViaReflectionSupport>
      <MauiEnableXamlCBindingWithSourceCompilation Condition="'$(MauiEnableXamlCBindingWithSourceCompilation)' == ''">true</MauiEnableXamlCBindingWithSourceCompilation>
      <MauiHybridWebViewSupported Condition="'$(MauiHybridWebViewSupported)' == ''">false</MauiHybridWebViewSupported>
      <!-- FIXME: https://github.com/xamarin/xamarin-macios/issues/22065 -->
      <MobileAggressiveAttributeTrimming Condition="'$(PublishAot)' == 'true' and '$(MobileAggressiveAttributeTrimming)' == ''">false</MobileAggressiveAttributeTrimming>
      
      <!-- Set _EnableMauiAspire based on whether optimizations are enabled when not already set -->
      <_EnableMauiAspire Condition="'$(_EnableMauiAspire)' == '' and '$(Optimize)' != 'true'">true</_EnableMauiAspire>
      <_EnableMauiAspire Condition="'$(_EnableMauiAspire)' == ''">false</_EnableMauiAspire>
    </PropertyGroup>
    <ItemGroup>
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.IsIVisualAssemblyScanningEnabled"
                                      Condition="'$(MauiEnableIVisualAssemblyScanning)' != ''"
                                      Value="$(MauiEnableIVisualAssemblyScanning)"
                                      Trim="true" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.IsShellSearchResultsRendererDisplayMemberNameSupported"
                                      Condition="'$(MauiShellSearchResultsRendererDisplayMemberNameSupported)' != ''"
                                      Value="$(MauiShellSearchResultsRendererDisplayMemberNameSupported)"
                                      Trim="true" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.IsQueryPropertyAttributeSupported"
                                      Condition="'$(MauiQueryPropertyAttributeSupport)' != ''"
                                      Value="$(MauiQueryPropertyAttributeSupport)"
                                      Trim="true" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.IsImplicitCastOperatorsUsageViaReflectionSupported"
                                      Condition="'$(MauiImplicitCastOperatorsUsageViaReflectionSupport)' != ''"
                                      Value="$(MauiImplicitCastOperatorsUsageViaReflectionSupport)"
                                      Trim="true" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.AreBindingInterceptorsSupported"
                                      Condition="'$(_MauiBindingInterceptorsSupport)' != ''"
                                      Value="$(_MauiBindingInterceptorsSupport)"
                                      Trim="true" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.IsXamlCBindingWithSourceCompilationEnabled"
                                      Condition="'$(MauiEnableXamlCBindingWithSourceCompilation)' != ''"
                                      Value="$(MauiEnableXamlCBindingWithSourceCompilation)"
                                      Trim="false" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.IsHybridWebViewSupported"
                                      Condition="'$(MauiHybridWebViewSupported)' != ''"
                                      Value="$(MauiHybridWebViewSupported)"
                                      Trim="true" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.AreNamescopesSupported"
                                      Condition="'$(MauiNamescopesSupported)' != ''"
                                      Value="$(MauiNamescopesSupported)"
                                      Trim="true" />      
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.EnableDiagnostics"
                                      Condition="'$(EnableDiagnostics)' != ''"
                                      Value="$(EnableDiagnostics)"
                                      Trim="true" />
      <RuntimeHostConfigurationOption Include="Microsoft.Maui.RuntimeFeature.EnableMauiAspire"
                                      Condition="'$(_EnableMauiAspire)' != ''"
                                      Value="$(_EnableMauiAspire)"
                                      Trim="true" />
    </ItemGroup>
  </Target>

  <Target Name="_MauiSetWinUIDefaultsForPublishAot" BeforeTargets="PrepareForBuild" Condition="'$(PublishAot)' == 'true' and '$(_MauiTargetPlatformIsWindows)' == 'True'">
    <PropertyGroup>
      <DebugSymbols Condition="'$(DebugSymbols)' == ''">false</DebugSymbols>
      <DebugType Condition="'$(DebugType)' == ''">None</DebugType>
      <EmbedXbfInPri Condition="'$(EmbedXbfInPri)' == ''">false</EmbedXbfInPri>
      <SelfContained Condition="'$(SelfContained)' == ''">true</SelfContained>
      <WindowsPackageType Condition="'$(WindowsPackageType)' == ''">None</WindowsPackageType>
    </PropertyGroup>
  </Target>

</Project>
