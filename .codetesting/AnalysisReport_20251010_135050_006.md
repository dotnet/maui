# Test Failures due possible code bugs

## SourceGen.UnitTests.csproj - GetWarningDisable_ComplexXmlStructure_ProcessesOnlyXamlCompInstructions
- **Confidence**: High
- **Test File**: src/Controls/tests/SourceGen.UnitTests/CodeBehindCodeWriterTests.cs
- **Bug Location**: src/Controls/src/SourceGen/CodeBehindCodeWriter.cs@379

### Analysis
The production code uses the XPath query 'processing-instruction('xaml-comp')' which only finds processing instructions at the document level, not those nested within elements. The test XML has two xaml-comp processing instructions: one at the document level and one inside the root element. The current XPath only finds the first one. The XPath should be '//processing-instruction('xaml-comp')' to find all xaml-comp processing instructions anywhere in the document.

### Suggested Fix
In the GetWarningDisable method at line 379, change the XPath query from 'processing-instruction('xaml-comp')' to '//processing-instruction('xaml-comp')' to find all xaml-comp processing instructions anywhere in the XML document, not just at the document root level.

## SourceGen.UnitTests.csproj - GetWarningDisable_WhitespaceOnlyAfterTrimming_PreservesWhitespace
- **Confidence**: High
- **Test File**: src/Controls/tests/SourceGen.UnitTests/CodeBehindCodeWriterTests.cs
- **Bug Location**: src/Controls/src/SourceGen/CodeBehindCodeWriter.cs@384

### Analysis
The production code has a bug in the parsing logic at line 384. When splitting the processing instruction data by both space and equals characters, it incorrectly breaks apart quoted values that contain spaces. For the input 'warning-disable="   "', the split operation produces ['warning-disable', '"', '', '', '"'] instead of preserving the quoted whitespace content. The code then takes the element after 'warning-disable' which is '"' and after trimming quotes becomes an empty string, when it should preserve the original '   ' (three spaces) content.

### Suggested Fix
The GetWarningDisable method needs to be fixed to properly parse quoted values containing spaces. The current split logic at line 384 `var parts = xpi.Data.Split(' ', '=');` should be replaced with more sophisticated parsing that respects quoted strings. A possible fix would be to use regular expressions or a proper key-value parser that handles quoted values. For example, use a pattern like `warning-disable\s*=\s*["']([^"']*)["']` to extract the quoted value directly, or implement a parser that doesn't split within quoted strings.

